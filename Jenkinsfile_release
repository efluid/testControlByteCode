node('socle-jenkins-maven-docker-14-4G') {

  checkout scm

  try{
    env.JAVA_HOME = "${variables.jdkPathPrefix}11.0.1"
    steps.withCredentials([[$class: 'UsernamePasswordMultiBinding', credentialsId: credentials.httpProxyAuthentication, passwordVariable: 'proxyPassword', usernameVariable: 'proxyUsername']]) {
      env.HTTP_PROXY="http://${env.proxyUsername}:${env.proxyPassword}@${variables.httpProxyHost}:${variables.httpProxyPort}"
      env.HTTPS_PROXY="http://${env.proxyUsername}:${env.proxyPassword}@${variables.httpProxyHost}:${variables.httpProxyPort}"
    }
    sh 'mvn release:prepare release:perform'
    sh 'git push origin master'
  } catch (Exception e) {
    //TODO send mail
    throw e
  }
}
return this;
